BEGIN{
     USE_INC = inc;
     if (USE_INC == "")
        USE_INC = "none";
     USE_NAME = toupper(name);
     if (USE_NAME == "")
        USE_NAME = "NONE";
     printf("/*\n     Autogenerated file. Please do not edit.\n*/\n");
     printf("#include <stdlib.h>\n");
     printf("#include \"%s\"\n\n", USE_INC);
     printf("struct {\n     const char *n;\n     const char *v;\n} _CI_CONF_%s[] = {\n", USE_NAME);
}
{
   n = match($0, /^\s*#\s*define\s+([[:alnum:]_]+)\s*(.*)$/, def);
   if (n != 0) {
        escaped = gensub(/"/, "\\\\\"", "g", def[2]);
        printf("#if defined(%s)\n     {\"%s\", \"%s\"},\n#endif\n", def[1], def[1], escaped);
   }
}
END{
     printf("     {NULL, NULL}\n};\n");
}
